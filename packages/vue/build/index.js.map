{"version":3,"sources":["../src/index.ts","../../runtime-dom/src/index.ts","../../shared/src/toDisplayString.ts","../../shared/src/index.ts","../../runtime-core/src/vnode.ts","../../runtime-core/src/h.ts","../../runtime-core/helpers/renderSlot.ts","../../reactivity/src/effect.ts","../../reactivity/src/baseHandler.ts","../../reactivity/src/reactive.ts","../../reactivity/src/ref.ts","../../runtime-core/src/componentEmit.ts","../../runtime-core/src/componentProps.ts","../../runtime-core/src/componentPublicInstance.ts","../../runtime-core/src/componentSlots.ts","../../runtime-core/src/component.ts","../../runtime-core/src/apiInject.ts","../../runtime-core/src/componentUpdateUtils.ts","../../runtime-core/src/createApp.ts","../../runtime-core/src/scheduler.ts","../../runtime-core/src/renderer.ts","../../compiler-core/src/runtimeHelpers.ts","../../compiler-core/src/ast.ts","../../compiler-core/src/codegen.ts","../../compiler-core/src/parse.ts","../../compiler-core/src/transform.ts","../../compiler-core/src/transforms/transformElement.ts","../../compiler-core/src/transforms/transformExpression.ts","../../compiler-core/src/utils.ts","../../compiler-core/src/transforms/transformText.ts","../../compiler-core/src/complier.ts"],"sourcesContent":["// mini-vue的出口\r\nexport * from '@mini-vue3/runtime-dom'\r\n\r\nexport * from '@mini-vue3/runtime-dom'\r\nimport { baseCompile } from '@mini-vue3/compiler-core'\r\nimport * as runtimeDom from '@mini-vue3/runtime-dom'\r\nimport { registerRuntimeCompiler } from '@mini-vue3/runtime-dom'\r\n\r\nfunction compileToFunction(template) {\r\n  const { code } = baseCompile(template)\r\n  const render = new Function('Vue', code)(runtimeDom)\r\n  return render\r\n}\r\n\r\nregisterRuntimeCompiler(compileToFunction)\r\n","import { createRenderer } from '@mini-vue3/runtime-core'\r\n\r\nfunction createElement(type) {\r\n  return document.createElement(type)\r\n}\r\n\r\nfunction patchProp(el, key, prevVal, nextVal) {\r\n  const isOn = (key: string) => /^on[A-Z]/.test(key)\r\n  if (isOn(key)) {\r\n    const event = key.slice(2).toLowerCase()\r\n    el.addEventListener(event, nextVal)\r\n  } else {\r\n    if (nextVal === undefined || nextVal === null) {\r\n      el.removeAttribute(key)\r\n    } else {\r\n      el.setAttribute(key, nextVal)\r\n    }\r\n  }\r\n}\r\n\r\nfunction insert(children, parent, anchor) {\r\n  // parent.append(el)\r\n  parent.insertBefore(children, anchor || null)\r\n}\r\n\r\nfunction remove(children) {\r\n  const parent = children.parentNode\r\n  if (parent) {\r\n    parent.removeChild(children)\r\n  }\r\n}\r\n\r\nfunction setElementText(el, text) {\r\n  el.textContent = text\r\n}\r\n\r\nconst renderer: any = createRenderer({\r\n  createElement,\r\n  patchProp,\r\n  insert,\r\n  remove,\r\n  setElementText,\r\n})\r\n\r\nexport function createApp(...args) {\r\n  return renderer.createApp(...args)\r\n}\r\n\r\nexport * from '@mini-vue3/runtime-core'\r\n","export function toDisplayString(value) {\r\n  return String(value)\r\n}\r\n","export * from './toDisplayString'\r\n\r\nexport const extend = Object.assign\r\n\r\nexport const EMPTY_OBJ = {}\r\n\r\nexport const isString = (value) => typeof value === 'string'\r\n\r\nexport const isObject = (val) => {\r\n  return val !== null && typeof val === 'object'\r\n}\r\n\r\nexport const isFunction = (val) => {\r\n  return typeof val === 'function'\r\n}\r\n\r\nexport const hasChanged = (val, newValue) => !Object.is(val, newValue)\r\n\r\nexport const hasOwn = (val, key) =>\r\n  Object.prototype.hasOwnProperty.call(val, key)\r\n\r\nexport const camelize = (str: string) => {\r\n  return str.replace(/-(\\w)/g, (_, c: string) => {\r\n    return c ? c.toUpperCase() : ''\r\n  })\r\n}\r\n\r\nexport const capitalize = (str: string) => {\r\n  return str.charAt(0).toUpperCase() + str.slice(1)\r\n}\r\n\r\nexport const toHandlerKey = (str: string) => {\r\n  return str ? 'on' + capitalize(str) : ''\r\n}\r\n\r\nexport { ShapeFlags } from './ShapeFlags'\r\n","import { ShapeFlags } from '@mini-vue3/shared'\r\n\r\nexport const Fragment = Symbol('Fragment')\r\nexport const Text = Symbol('Text')\r\n\r\nexport { createVnode as createElementVNode }\r\n\r\nexport function createVnode(type, props?, children?) {\r\n  const vnode = {\r\n    type,\r\n    props,\r\n    children,\r\n    component: null,\r\n    key: props && props.key,\r\n    shapeFlag: getShapeFlag(type),\r\n    el: null,\r\n  }\r\n  if (typeof children === 'string') {\r\n    vnode.shapeFlag |= ShapeFlags.TEXT_CHILDREN\r\n  } else if (Array.isArray(children)) {\r\n    vnode.shapeFlag |= ShapeFlags.ARRAY_CHILDREN\r\n  }\r\n\r\n  if (vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT) {\r\n    if (typeof children === 'object') {\r\n      vnode.shapeFlag |= ShapeFlags.SLOT_CHILDREN\r\n    }\r\n  }\r\n  return vnode\r\n}\r\n\r\nexport function createTextVNode(text: string) {\r\n  console.log(createVnode(Text, {}, text))\r\n  return createVnode(Text, {}, text)\r\n}\r\n\r\nfunction getShapeFlag(type: any) {\r\n  return typeof type === 'string'\r\n    ? ShapeFlags.ELEMENT\r\n    : ShapeFlags.STATEFUL_COMPONENT\r\n}\r\n","import { createVnode } from './vnode'\r\n\r\nexport function h(type, props?, children?) {\r\n  return createVnode(type, props, children)\r\n}\r\n","import { createVnode, Fragment } from '../src/vnode'\r\n\r\nexport function renderSlots(slots, name, props) {\r\n  const slot = slots[name]\r\n  if (slot) {\r\n    return createVnode(Fragment, {}, slot(props))\r\n  }\r\n}\r\n","import { extend } from '@mini-vue3/shared'\r\n\r\nlet activeEffect\r\nlet shouldTrack\r\n\r\nexport class ReactiveEffect {\r\n  private _fn: any\r\n  deps = []\r\n  active = true\r\n  onStop?: () => void\r\n  public scheduler: Function | undefined\r\n  constructor(fn, scheduler?: Function) {\r\n    this._fn = fn\r\n    this.scheduler = scheduler\r\n  }\r\n  run() {\r\n    // 会收集依赖\r\n    // shouldTrack做区分\r\n    if (!this.active) {\r\n      return this._fn()\r\n    }\r\n    // 应该收集\r\n    shouldTrack = true\r\n    activeEffect = this\r\n    const result = this._fn()\r\n    // 重置\r\n    shouldTrack = false\r\n    return result\r\n  }\r\n  stop() {\r\n    cleanupEffect(this)\r\n    if (this.onStop) {\r\n      this.onStop()\r\n    }\r\n    this.active = false\r\n  }\r\n}\r\n\r\nfunction cleanupEffect(effect) {\r\n  effect.deps.forEach((dep: any) => {\r\n    dep.delete(effect)\r\n  })\r\n\r\n  // 把 effect.deps 清空\r\n  effect.deps.length = 0\r\n}\r\n\r\nconst targetMap = new WeakMap()\r\nexport function track(target, key) {\r\n  if (!isTracking()) return\r\n  // 用Set存储依赖\r\n  // target -> key -> dep\r\n  let depsMap = targetMap.get(target)\r\n  if (!depsMap) {\r\n    depsMap = new Map()\r\n    targetMap.set(target, depsMap)\r\n  }\r\n\r\n  let dep = depsMap.get(key)\r\n  if (!dep) {\r\n    dep = new Set()\r\n    depsMap.set(key, dep)\r\n  }\r\n  trackEffects(dep)\r\n}\r\n\r\nexport function trackEffects(dep) {\r\n  // 看看 dep 之前有没有添加过，添加过的话 那么就不添加了\r\n  if (dep.has(activeEffect)) return\r\n  dep.add(activeEffect)\r\n  activeEffect.deps.push(dep)\r\n}\r\n\r\nexport function isTracking() {\r\n  return shouldTrack && activeEffect !== undefined\r\n}\r\n\r\nexport function trigger(target, key) {\r\n  let depsMap = targetMap.get(target)\r\n  let dep = depsMap.get(key)\r\n  triggerEffects(dep)\r\n}\r\n\r\nexport function triggerEffects(dep) {\r\n  for (const effect of dep) {\r\n    if (effect.scheduler) {\r\n      effect.scheduler()\r\n    } else {\r\n      effect.run()\r\n    }\r\n  }\r\n}\r\n\r\nexport function effect(fn, options: any = {}) {\r\n  const _effect = new ReactiveEffect(fn, options.scheduler)\r\n  extend(_effect, options)\r\n\r\n  _effect.run()\r\n  const runner: any = _effect.run.bind(_effect)\r\n  runner.effect = _effect\r\n\r\n  return runner\r\n}\r\n\r\nexport function stop(runner) {\r\n  runner.effect.stop()\r\n}\r\n","import { extend, isObject } from '@mini-vue3/shared'\r\nimport { track, trigger } from './effect'\r\nimport { reactive, ReactiveFlags, readonly } from './reactive'\r\n\r\nconst get = createGetter()\r\nconst set = createSetter()\r\nconst readonlyGet = createGetter(true)\r\nconst shallowReadonlyGet = createGetter(true, true)\r\n\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n  return function get(target, key) {\r\n    if (key === ReactiveFlags.IS_REACTIVE) {\r\n      return !isReadonly\r\n    } else if (key === ReactiveFlags.IS_READONLY) {\r\n      return isReadonly\r\n    }\r\n    const res = Reflect.get(target, key)\r\n\r\n    if (shallow) {\r\n      return res\r\n    }\r\n\r\n    // 看看res是不是一个对象\r\n    if (isObject(res)) {\r\n      return isReadonly ? readonly(res) : reactive(res)\r\n    }\r\n\r\n    //TODO 依赖收集\r\n    if (!isReadonly) {\r\n      track(target, key)\r\n    }\r\n    return res\r\n  }\r\n}\r\n\r\nfunction createSetter() {\r\n  return function set(target, key, value) {\r\n    const res = Reflect.set(target, key, value)\r\n    //TODO 触发依赖\r\n    trigger(target, key)\r\n    return res\r\n  }\r\n}\r\n\r\nexport const mutableHandlers = {\r\n  get,\r\n  set,\r\n}\r\n\r\nexport const readonlyHandlers = {\r\n  get: readonlyGet,\r\n  set(target, key) {\r\n    console.warn(\r\n      `key :\"${String(key)}\" set 失败，因为 target 是 readonly 类型`,\r\n      target\r\n    )\r\n\r\n    return true\r\n  },\r\n}\r\n\r\nexport const shallowReadonlyHandlers = extend({}, readonlyHandlers, {\r\n  get: shallowReadonlyGet,\r\n})\r\n","import { isObject } from '@mini-vue3/shared'\r\nimport {\r\n  mutableHandlers,\r\n  readonlyHandlers,\r\n  shallowReadonlyHandlers,\r\n} from './baseHandler'\r\n\r\nexport const enum ReactiveFlags {\r\n  IS_REACTIVE = '__v__isReactive',\r\n  IS_READONLY = '__v_isReadonly',\r\n}\r\n\r\nexport function reactive(raw) {\r\n  return createActiveObject(raw, mutableHandlers)\r\n}\r\n\r\nexport function readonly(raw) {\r\n  return createActiveObject(raw, readonlyHandlers)\r\n}\r\n\r\nexport function shallowReadonly(raw) {\r\n  return createActiveObject(raw, shallowReadonlyHandlers)\r\n}\r\n\r\nexport function isReactive(value) {\r\n  return !!value[ReactiveFlags.IS_REACTIVE]\r\n}\r\n\r\nexport function isReadonly(value) {\r\n  return !!value[ReactiveFlags.IS_READONLY]\r\n}\r\n\r\nexport function isProxy(value) {\r\n  return isReactive(value) || isReadonly(value)\r\n}\r\n\r\nfunction createActiveObject(target: any, baseHandlers) {\r\n  if (!isObject(target)) {\r\n    console.warn(`target ${target} 必须是一个对象`)\r\n    return target\r\n  }\r\n  return new Proxy(target, baseHandlers)\r\n}\r\n","import { hasChanged, isObject } from '@mini-vue3/shared'\r\nimport { isTracking, trackEffects, triggerEffects } from './effect'\r\nimport { reactive } from './reactive'\r\n\r\n// 传过来的基本数据类型没办法get和set\r\n// 所以用一个对象包裹住，这就是ref要使用.value的原因\r\n\r\nclass RefImpl {\r\n  private _value: any\r\n  public dep\r\n  private _rawValue\r\n  public __v_isRef = true\r\n  constructor(value) {\r\n    this._rawValue = value\r\n    // 看看value是不是对象，如果是对象用reactive包裹\r\n    this._value = convert(value)\r\n    this.dep = new Set()\r\n  }\r\n  get value() {\r\n    trackRefValue(this)\r\n    return this._value\r\n  }\r\n\r\n  set value(newValue) {\r\n    // 如果两次设置的值相等，不触发依赖\r\n    if (hasChanged(this._rawValue, newValue)) {\r\n      this._rawValue = newValue\r\n      this._value = convert(newValue)\r\n      triggerEffects(this.dep)\r\n    }\r\n  }\r\n}\r\n\r\nfunction convert(value) {\r\n  return isObject(value) ? reactive(value) : value\r\n}\r\n\r\nfunction trackRefValue(ref) {\r\n  if (isTracking()) {\r\n    trackEffects(ref.dep)\r\n  }\r\n}\r\n\r\nexport function ref(value) {\r\n  return new RefImpl(value)\r\n}\r\n\r\nexport function isRef(ref) {\r\n  return !!ref.__v_isRef\r\n}\r\n\r\nexport function unRef(ref) {\r\n  // 是ref对象返回ref.value否则返回初始值\r\n  return isRef(ref) ? ref.value : ref\r\n}\r\n\r\nexport function proxyRefs(objectWithRefs) {\r\n  return new Proxy(objectWithRefs, {\r\n    get(target, key) {\r\n      return unRef(Reflect.get(target, key))\r\n    },\r\n    set(target, key, value) {\r\n      if (isRef(target[key]) && !isRef(value)) {\r\n        return (target[key].value = value)\r\n      } else {\r\n        return Reflect.set(target, key, value)\r\n      }\r\n    },\r\n  })\r\n}\r\n","import { camelize, toHandlerKey } from '@mini-vue3/shared'\r\n\r\nexport function emit(instance, event, ...args) {\r\n  console.log('emit:' + event)\r\n  const { props } = instance\r\n  // TPP开发\r\n  // 先去写一个特定的行为 -> 重构成通用的行为\r\n  // add -> Add\r\n  // 例如:\r\n  // const handler = props['onAdd']\r\n  // handler && handler()\r\n\r\n  const handleName = toHandlerKey(camelize(event))\r\n  console.log(handleName)\r\n  const handler = props[handleName]\r\n  handler && handler(...args)\r\n}\r\n","export function initProps(instance, rawProps) {\r\n  instance.props = rawProps || {}\r\n}\r\n","import { hasOwn } from '@mini-vue3/shared'\r\n\r\nconst publicPropertiesMap = {\r\n  $el: (i) => i.vnode.el,\r\n  $slots: (i) => i.slots,\r\n  $props: (i) => i.props,\r\n}\r\n\r\nexport const publicInstanceProxyHandlers = {\r\n  get({ _: instance }, key) {\r\n    const { setupState, props } = instance\r\n    // 从setupState里取值\r\n    if (hasOwn(setupState, key)) {\r\n      return setupState[key]\r\n    } else if (hasOwn(props, key)) {\r\n      return props[key]\r\n    }\r\n    const publicGetter = publicPropertiesMap[key]\r\n    if (publicGetter) {\r\n      return publicGetter(instance)\r\n    }\r\n  },\r\n}\r\n","import { ShapeFlags } from '@mini-vue3/shared'\r\n\r\nexport function initSlots(instance, children) {\r\n  const { vnode } = instance\r\n  // slots\r\n  if (vnode.shapeFlag & ShapeFlags.SLOT_CHILDREN) {\r\n    normalizeObjectSlots(children, instance.slots)\r\n  }\r\n}\r\n\r\nfunction normalizeObjectSlots(children: any, slots: any) {\r\n  for (const key in children) {\r\n    const value = children[key]\r\n    slots[key] = (props) => normalizeSlotValue(value(props))\r\n  }\r\n}\r\n\r\nfunction normalizeSlotValue(value) {\r\n  return Array.isArray(value) ? value : [value]\r\n}\r\n","import { proxyRefs } from '@mini-vue3/reactivity'\r\nimport { shallowReadonly } from '@mini-vue3/reactivity'\r\nimport { emit } from './componentEmit'\r\nimport { initProps } from './componentProps'\r\nimport { publicInstanceProxyHandlers } from './componentPublicInstance'\r\nimport { initSlots } from './componentSlots'\r\n\r\nlet currentInstance = null\r\n\r\nexport function createComponentInstance(vnode, parent) {\r\n  const component = {\r\n    vnode,\r\n    type: vnode.type,\r\n    next: null,\r\n    setupState: {},\r\n    props: {},\r\n    slots: {},\r\n    provides: parent ? parent.provides : {},\r\n    parent,\r\n    isMounted: false,\r\n    subTree: {},\r\n    emit: () => {},\r\n  }\r\n  component.emit = emit.bind(null, component) as any\r\n  return component\r\n}\r\n\r\nexport function setupComponent(instance) {\r\n  // 初始化props\r\n  initProps(instance, instance.vnode.props)\r\n  initSlots(instance, instance.vnode.children)\r\n  setupStatefulComponent(instance)\r\n}\r\n\r\nfunction setupStatefulComponent(instance: any) {\r\n  const Component = instance.type\r\n  // ctx\r\n  instance.proxy = new Proxy({ _: instance }, publicInstanceProxyHandlers)\r\n  const { setup } = Component\r\n  if (setup) {\r\n    setCurrentInstance(instance)\r\n    // 返回object或function\r\n    const setupResult = setup(shallowReadonly(instance.props), {\r\n      emit: instance.emit,\r\n    })\r\n    setCurrentInstance(null)\r\n    handleSetupResult(instance, setupResult)\r\n  }\r\n}\r\n\r\nfunction handleSetupResult(instance, setupResult: any) {\r\n  if (typeof setupResult === 'object') {\r\n    instance.setupState = proxyRefs(setupResult)\r\n    // console.log(instance.setupState)\r\n  }\r\n  // 保证组件的render有值\r\n  finishComponentSetup(instance)\r\n}\r\n\r\nfunction finishComponentSetup(instance: any) {\r\n  const Component = instance.type\r\n  if (compiler && !Component.render) {\r\n    Component.render = compiler(Component.template)\r\n  }\r\n  instance.render = Component.render\r\n}\r\n\r\nexport function getCurrentInstance() {\r\n  return currentInstance\r\n}\r\n\r\nexport function setCurrentInstance(instance) {\r\n  currentInstance = instance\r\n}\r\n\r\nlet compiler\r\n\r\nexport function registerRuntimeCompiler(_compiler) {\r\n  compiler = _compiler\r\n}\r\n","import { getCurrentInstance } from './component'\r\n\r\nexport function provide(key, value) {\r\n  // 只能在setup里使用\r\n  const currentInstance: any = getCurrentInstance()\r\n  let { provides } = currentInstance\r\n  const parentProvides = currentInstance.parent.provides\r\n  if (provides === parentProvides) {\r\n    provides = currentInstance.provides = Object.create(parentProvides)\r\n  }\r\n  provides[key] = value\r\n}\r\n\r\nexport function inject(key, defaultValue) {\r\n  const currentInstance: any = getCurrentInstance()\r\n  if (currentInstance) {\r\n    const parentProvides = currentInstance.parent.provides\r\n    console.log(parentProvides)\r\n    if (key in parentProvides) {\r\n      return parentProvides[key]\r\n    } else if (defaultValue) {\r\n      if (typeof defaultValue === 'function') {\r\n        return defaultValue()\r\n      }\r\n      return defaultValue\r\n    }\r\n  }\r\n}\r\n","export function shouldUpdateComponent(prevVNode, nextVNode) {\r\n  const { props: prevProps } = prevVNode\r\n  const { props: nextProps } = nextVNode\r\n  for (const key in nextProps) {\r\n    if (nextProps[key] !== prevProps[key]) {\r\n      return true\r\n    }\r\n  }\r\n  return false\r\n}\r\n","import { createVnode } from './vnode'\r\n\r\nexport function createAppAPI(render) {\r\n  return function createApp(rootComponent) {\r\n    return {\r\n      mount(rootContainer) {\r\n        // 先vnode\r\n        // component => vnode\r\n        // 所有的逻辑都会基于vnode做处理\r\n        const vnode = createVnode(rootComponent)\r\n        render(vnode, rootContainer)\r\n      },\r\n    }\r\n  }\r\n}\r\n","const queue: any[] = []\r\n\r\nconst p = Promise.resolve()\r\nlet isFlushPending = false\r\n\r\nexport function nextTick(fn) {\r\n  return fn ? p.then(fn) : p\r\n}\r\n\r\nexport function queueJobs(job) {\r\n  if (!queue.includes(job)) {\r\n    queue.push(job)\r\n  }\r\n  queueFlush()\r\n}\r\n\r\nfunction queueFlush() {\r\n  if (isFlushPending) return\r\n  isFlushPending = true\r\n  nextTick(flushJobs)\r\n}\r\n\r\nfunction flushJobs() {\r\n  isFlushPending = false\r\n  let job\r\n  while ((job = queue.shift())) {\r\n    job && job()\r\n  }\r\n}\r\n","import { effect } from '@mini-vue3/reactivity'\r\nimport { EMPTY_OBJ, ShapeFlags } from '@mini-vue3/shared'\r\nimport { createComponentInstance, setupComponent } from './component'\r\nimport { shouldUpdateComponent } from './componentUpdateUtils'\r\nimport { createAppAPI } from './createApp'\r\nimport { queueJobs } from './scheduler'\r\nimport { Fragment, Text } from './vnode'\r\n\r\nexport function createRenderer(options) {\r\n  const {\r\n    createElement: hostCreateElement,\r\n    patchProp: hostPatchProp,\r\n    insert: hostInsert,\r\n    remove: hostRemove,\r\n    setElementText: hostSetElementText,\r\n  } = options\r\n  function render(vnode, container) {\r\n    patch(null, vnode, container, null, null)\r\n  }\r\n\r\n  // n1->老虚拟节点 n2->新虚拟节点\r\n  function patch(n1, n2, container, parentComponent, anchor) {\r\n    // 判断element类型还是组件类型\r\n    // console.log(vnode.type)\r\n    const { type, shapeFlag } = n2\r\n    // Fragment -> 只渲染 children\r\n    switch (type) {\r\n      case Fragment:\r\n        processFragment(n1, n2, container, parentComponent, anchor)\r\n        break\r\n      case Text:\r\n        processText(n1, n2, container)\r\n        break\r\n      default:\r\n        if (shapeFlag & ShapeFlags.ELEMENT) {\r\n          // element类型\r\n          processElement(n1, n2, container, parentComponent, anchor)\r\n        } else if (shapeFlag & ShapeFlags.STATEFUL_COMPONENT) {\r\n          // STATEFUL_COMPONENT类型\r\n          processComponent(n1, n2, container, parentComponent, anchor)\r\n        }\r\n    }\r\n  }\r\n\r\n  function processFragment(n1, n2, container: any, parentComponent, anchor) {\r\n    mountChildren(n2.children, container, parentComponent, anchor)\r\n  }\r\n\r\n  function processText(n1, n2, container: any) {\r\n    const { children } = n2\r\n    const textNode = document.createTextNode(children)\r\n    n2.el = textNode\r\n    container.append(textNode)\r\n  }\r\n\r\n  function processElement(n1, n2, container, parentComponent, anchor) {\r\n    if (!n1) {\r\n      mountElement(n2, container, parentComponent, anchor)\r\n    } else {\r\n      patchElement(n1, n2, container, parentComponent, anchor)\r\n    }\r\n  }\r\n\r\n  function patchElement(n1, n2, container, parentComponent, anchor) {\r\n    const el = n1.el\r\n    n2.el = el\r\n    console.log(n1)\r\n    console.log(n2)\r\n    const oldProps = n1.props || EMPTY_OBJ\r\n    const newProps = n2.props || EMPTY_OBJ\r\n    patchChildren(n1, n2, el, parentComponent, anchor)\r\n    patchProps(el, oldProps, newProps)\r\n  }\r\n\r\n  function patchChildren(n1, n2, container, parentComponent, anchor) {\r\n    const preShapeFlag = n1.shapeFlag\r\n    const c1 = n1.children\r\n    const { shapeFlag } = n2\r\n    const c2 = n2.children\r\n\r\n    if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n      if (preShapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n        // 1.把老的children清空\r\n        unmountChildren(n1.children)\r\n      }\r\n      if (c1 !== c2) {\r\n        // 2.设置 text\r\n        hostSetElementText(container, c2)\r\n      }\r\n    } else {\r\n      // new Array\r\n      if (preShapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n        hostSetElementText(container, '')\r\n        mountChildren(c2, container, parentComponent, anchor)\r\n      } else {\r\n        // array diff array\r\n        patchKeyChildren(c1, c2, container, parentComponent, anchor)\r\n      }\r\n    }\r\n  }\r\n\r\n  function patchKeyChildren(c1, c2, container, parentComponent, parentAnchor) {\r\n    const l2 = c2.length\r\n    let i = 0\r\n    let e1 = c1.length - 1\r\n    let e2 = l2 - 1\r\n    function isSomeVNodeType(n1, n2) {\r\n      // type\r\n      // key\r\n      return n1.type === n2.type && n1.key === n2.key\r\n    }\r\n    // 左侧\r\n    while (i <= e1 && i <= e2) {\r\n      const n1 = c1[i]\r\n      const n2 = c2[i]\r\n      if (isSomeVNodeType(n1, n2)) {\r\n        patch(n1, n2, container, parentComponent, parentAnchor)\r\n      } else {\r\n        break\r\n      }\r\n      i++\r\n    }\r\n    // 右侧\r\n    while (i <= e1 && i <= e2) {\r\n      const n1 = c1[e1]\r\n      const n2 = c2[e2]\r\n      if (isSomeVNodeType(n1, n2)) {\r\n        patch(n1, n2, container, parentComponent, parentAnchor)\r\n      } else {\r\n        break\r\n      }\r\n      e1--\r\n      e2--\r\n      console.log(n1)\r\n      console.log(n2)\r\n    }\r\n    //新的比老的多\r\n    if (i > e1) {\r\n      if (i <= e2) {\r\n        const nextPos = e2 + 1\r\n        const anchor = nextPos < l2 ? c2[nextPos].el : null\r\n        while (i <= e2) {\r\n          patch(null, c2[i], container, parentComponent, anchor)\r\n          i++\r\n        }\r\n      }\r\n    } else if (i > e2) {\r\n      // 老的比新的多\r\n      while (i <= e1) {\r\n        hostRemove(c1[i].el)\r\n        i++\r\n      }\r\n    } else {\r\n      // 中间节点\r\n      let s1 = i\r\n      let s2 = i\r\n      // 记录新节点的中间children节点数\r\n      const toBePatched = e2 - s2 + 1\r\n      // 记录当前patch了多少个中间节点\r\n      let patched = 0\r\n      const keyToNewIndexMap = new Map()\r\n      // 存储子序列\r\n      let moved = false\r\n      // 记录老节点的当前子节点索引\r\n      let maxNewIndexSoFar = 0\r\n      const newIndexToOldIndexMap = new Array(toBePatched)\r\n      for (let i = 0; i < toBePatched; i++) {\r\n        newIndexToOldIndexMap[i] = 0\r\n      }\r\n      for (let i = s2; i <= e2; i++) {\r\n        const nextChild = c2[i]\r\n        keyToNewIndexMap.set(nextChild.key, i)\r\n      }\r\n      for (let i = s1; i <= e1; i++) {\r\n        const prevChild = c1[i]\r\n        // 新节点的中间children节点patch完了直接删除老节点中多余的\r\n        if (patched >= toBePatched) {\r\n          hostRemove(prevChild.el)\r\n          continue\r\n        }\r\n\r\n        let newIndex\r\n        if (prevChild.key != null) {\r\n          newIndex = keyToNewIndexMap.get(prevChild.key)\r\n        } else {\r\n          for (let j = s2; j <= e2; j++) {\r\n            if (isSomeVNodeType(prevChild, c2[j])) {\r\n              newIndex = j\r\n              break\r\n            }\r\n          }\r\n        }\r\n\r\n        if (newIndex === undefined) {\r\n          hostRemove(prevChild.el)\r\n        } else {\r\n          if (newIndex >= maxNewIndexSoFar) {\r\n            maxNewIndexSoFar = newIndex\r\n          } else {\r\n            moved = true\r\n          }\r\n          // 避免i=0的情况所以+1因为初始化newIndexToOldIndexMap全是0\r\n          newIndexToOldIndexMap[newIndex - s2] = i + 1\r\n          patch(prevChild, c2[newIndex], container, parentComponent, null)\r\n          patched++\r\n        }\r\n      }\r\n      // 最长递增子序列\r\n      const increasingNewIndexSequence = moved\r\n        ? getSequence(newIndexToOldIndexMap)\r\n        : []\r\n      let j = increasingNewIndexSequence.length - 1\r\n      for (let i = toBePatched - 1; i >= 0; i--) {\r\n        const nextIndex = i + s2\r\n        const nextChild = c2[nextIndex]\r\n        const anchor = nextIndex + 1 < l2 ? c2[nextIndex + 1].el : null\r\n\r\n        if (newIndexToOldIndexMap[i] === 0) {\r\n          // 老的里面不存在要创建新节点\r\n          patch(null, nextChild, container, parentComponent, anchor)\r\n        } else if (moved) {\r\n          if (j < 0 || i !== increasingNewIndexSequence[j]) {\r\n            hostInsert(nextChild.el, container, anchor)\r\n          } else {\r\n            j--\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function unmountChildren(children) {\r\n    for (let i = 0; i < children.length; i++) {\r\n      const el = children[i].el\r\n      // remove\r\n      hostRemove(el)\r\n    }\r\n  }\r\n\r\n  function patchProps(el, oldProps, newProps) {\r\n    if (oldProps !== newProps) {\r\n      for (const key in newProps) {\r\n        const preProp = oldProps[key]\r\n        const nextProp = newProps[key]\r\n        if (preProp !== nextProp) {\r\n          hostPatchProp(el, key, preProp, nextProp)\r\n        }\r\n      }\r\n\r\n      if (oldProps !== EMPTY_OBJ) {\r\n        for (const key in oldProps) {\r\n          if (!(key in newProps)) {\r\n            hostPatchProp(el, key, oldProps[key], null)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function mountElement(vnode, container, parentComponent, anchor) {\r\n    const el = hostCreateElement(vnode.type)\r\n    vnode.el = el\r\n    //children有string 和 array两种类型\r\n    const { children, shapeFlag } = vnode\r\n    if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n      // text_children\r\n      el.textContent = children\r\n    } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n      // 每一个children是vnode\r\n      // array_children\r\n      mountChildren(vnode.children, el, parentComponent, anchor)\r\n    }\r\n    // props\r\n    const { props } = vnode\r\n    for (let key in props) {\r\n      const val = props[key]\r\n      hostPatchProp(el, key, null, val)\r\n    }\r\n    // container.append(el)\r\n    hostInsert(el, container, anchor)\r\n  }\r\n\r\n  function mountChildren(\r\n    children: any,\r\n    container: any,\r\n    parentComponent,\r\n    anchor\r\n  ) {\r\n    children.forEach((v) => {\r\n      patch(null, v, container, parentComponent, anchor)\r\n    })\r\n  }\r\n\r\n  function processComponent(\r\n    n1,\r\n    n2: any,\r\n    container: any,\r\n    parentComponent: any,\r\n    anchor\r\n  ) {\r\n    if (!n1) {\r\n      mountComponent(n2, container, parentComponent, anchor)\r\n    } else {\r\n      updateComponent(n1, n2)\r\n    }\r\n  }\r\n\r\n  function updateComponent(n1, n2) {\r\n    const instance = n1.component\r\n    n2.component = instance\r\n    if (shouldUpdateComponent(n1, n2)) {\r\n      instance.next = n2\r\n      instance.update()\r\n    } else {\r\n      n2.el = n1.el\r\n      instance.vnode = n2\r\n    }\r\n  }\r\n\r\n  function mountComponent(\r\n    initinalvnode: any,\r\n    container: any,\r\n    parentComponent,\r\n    anchor\r\n  ) {\r\n    const instance = createComponentInstance(initinalvnode, parentComponent)\r\n    initinalvnode.component = instance\r\n    setupComponent(instance)\r\n    setupRenderEffect(instance, initinalvnode, container, anchor)\r\n  }\r\n\r\n  function setupRenderEffect(\r\n    instance: any,\r\n    initinalvnode,\r\n    container: any,\r\n    anchor\r\n  ) {\r\n    instance.update = effect(\r\n      () => {\r\n        if (!instance.isMounted) {\r\n          // 虚拟节点树\r\n          const { proxy } = instance\r\n          // this绑定proxy\r\n          // 第二个参数是因为template模板编译后要从_ctx里取数据\r\n          instance.subTree = instance.render.call(proxy, proxy)\r\n          const subTree = instance.subTree\r\n          patch(null, subTree, container, instance, anchor)\r\n          initinalvnode.el = subTree.el\r\n          instance.isMounted = true\r\n        } else {\r\n          const { next, vnode } = instance\r\n          if (next) {\r\n            next.el = vnode.el\r\n            updateComponentPreRender(instance, next)\r\n          }\r\n          // 虚拟节点树\r\n          const { proxy } = instance\r\n          // this绑定proxy\r\n          const subTree = instance.render.call(proxy, proxy)\r\n          const preSubTree = instance.subTree\r\n          instance.subTree = subTree\r\n          patch(preSubTree, subTree, container, instance, anchor)\r\n        }\r\n      },\r\n      {\r\n        scheduler() {\r\n          queueJobs(instance.update)\r\n        },\r\n      }\r\n    )\r\n  }\r\n  return {\r\n    createApp: createAppAPI(render),\r\n  }\r\n}\r\n\r\n// 更新instance\r\nfunction updateComponentPreRender(instance, nextVNode) {\r\n  instance.vnode = nextVNode\r\n  instance.next = null\r\n  instance.props = nextVNode.props\r\n}\r\n\r\n// 最长递增子序列\r\nfunction getSequence(arr) {\r\n  const p = arr.slice()\r\n  const result = [0]\r\n  let i, j, u, v, c\r\n  const len = arr.length\r\n  for (i = 0; i < len; i++) {\r\n    const arrI = arr[i]\r\n    if (arrI !== 0) {\r\n      j = result[result.length - 1]\r\n      if (arr[j] < arrI) {\r\n        p[i] = j\r\n        result.push(i)\r\n        continue\r\n      }\r\n      u = 0\r\n      v = result.length - 1\r\n      while (u < v) {\r\n        c = (u + v) >> 1\r\n        if (arr[result[c]] < arrI) {\r\n          u = c + 1\r\n        } else {\r\n          v = c\r\n        }\r\n      }\r\n      if (arrI < arr[result[u]]) {\r\n        if (u > 0) {\r\n          p[i] = result[u - 1]\r\n        }\r\n        result[u] = i\r\n      }\r\n    }\r\n  }\r\n  u = result.length\r\n  v = result[u - 1]\r\n  while (u-- > 0) {\r\n    result[u] = v\r\n    v = p[v]\r\n  }\r\n  return result\r\n}\r\n","export const TO_DISPLAY_STRING = Symbol('toDisplayString')\r\nexport const CREATE_ELEMENT_VNODE = Symbol('createElementVNode')\r\n\r\nexport const helperMapName = {\r\n  [TO_DISPLAY_STRING]: 'toDisplayString',\r\n  [CREATE_ELEMENT_VNODE]: 'createElementVNode',\r\n}\r\n","import { CREATE_ELEMENT_VNODE } from './runtimeHelpers'\r\n\r\nexport const enum NodeTypes {\r\n  INTERPOLATION,\r\n  SIMPLE_EXPRESSION,\r\n  ELEMENT,\r\n  TEXT,\r\n  ROOT,\r\n  COMPOUND_EXPRESSION,\r\n}\r\n\r\nexport function createVNodeCall(context, tag, props, children) {\r\n  context.helper(CREATE_ELEMENT_VNODE)\r\n\r\n  return {\r\n    type: NodeTypes.ELEMENT,\r\n    tag,\r\n    props,\r\n    children,\r\n  }\r\n}\r\n","import { isString } from '@mini-vue3/shared'\r\nimport { NodeTypes } from './ast'\r\nimport {\r\n  CREATE_ELEMENT_VNODE,\r\n  helperMapName,\r\n  TO_DISPLAY_STRING,\r\n} from './runtimeHelpers'\r\n\r\nexport function generate(ast) {\r\n  // console.log(ast)\r\n\r\n  const context = createCodegenContext()\r\n  const { push } = context\r\n  getFunctionPreamble(ast, context)\r\n\r\n  const functionName = 'render'\r\n  const args = ['_ctx', '_cache']\r\n  const signature = args.join(', ')\r\n\r\n  push(`function ${functionName}(${signature}){`)\r\n  push('return ')\r\n  console.log(ast)\r\n\r\n  genNode(ast.codegenNode, context)\r\n  push('}')\r\n\r\n  return {\r\n    code: context.code,\r\n  }\r\n}\r\n\r\nfunction getFunctionPreamble(ast, context) {\r\n  const { push } = context\r\n  const VueBinging = 'Vue'\r\n  const aliasHelper = (s) => `${helperMapName[s]}:_${helperMapName[s]}`\r\n  if (ast.helpers.length > 0) {\r\n    push(`const { ${ast.helpers.map(aliasHelper).join(', ')} } = ${VueBinging}`)\r\n  }\r\n  push('\\n')\r\n  push('return ')\r\n}\r\n\r\nfunction createCodegenContext(): any {\r\n  const context = {\r\n    code: '',\r\n    push(source) {\r\n      context.code += source\r\n    },\r\n    helper(key) {\r\n      return `_${helperMapName[key]}`\r\n    },\r\n  }\r\n  return context\r\n}\r\n\r\nfunction genNode(node: any, context) {\r\n  switch (node.type) {\r\n    case NodeTypes.TEXT:\r\n      // text类型\r\n      genText(context, node)\r\n      break\r\n    case NodeTypes.INTERPOLATION:\r\n      // 插值类型\r\n      genInterpolation(node, context)\r\n      break\r\n    case NodeTypes.SIMPLE_EXPRESSION:\r\n      genExpression(node, context)\r\n      break\r\n    case NodeTypes.ELEMENT:\r\n      genElement(node, context)\r\n      break\r\n    case NodeTypes.COMPOUND_EXPRESSION:\r\n      genCompoundExpression(node, context)\r\n      break\r\n    default:\r\n      break\r\n  }\r\n}\r\n\r\nfunction genCompoundExpression(node, context) {\r\n  const { push } = context\r\n  const children = node.children\r\n  for (let i = 0; i < children.length; i++) {\r\n    const child = children[i]\r\n    if (isString(child)) {\r\n      push(child)\r\n    } else {\r\n      genNode(child, context)\r\n    }\r\n  }\r\n}\r\n\r\nfunction genElement(node, context) {\r\n  const { push, helper } = context\r\n  const { tag, children, props } = node\r\n  push(`${helper(CREATE_ELEMENT_VNODE)}(`)\r\n  genNodeList(genNullable([tag, props, children]), context)\r\n  push(')')\r\n}\r\n\r\nfunction genNodeList(nodes, context) {\r\n  const { push } = context\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    const node = nodes[i]\r\n    if (isString(node)) {\r\n      push(node)\r\n    } else {\r\n      genNode(node, context)\r\n    }\r\n    if (i < nodes.length - 1) {\r\n      push(', ')\r\n    }\r\n  }\r\n}\r\n\r\nfunction genNullable(args: any) {\r\n  return args.map((arg) => arg || 'null')\r\n}\r\n\r\nfunction genExpression(node, context) {\r\n  const { push } = context\r\n  push(`${node.content}`)\r\n}\r\n\r\nfunction genInterpolation(node, context) {\r\n  // console.log(node)\r\n  const { push, helper } = context\r\n\r\n  push(`${helper(TO_DISPLAY_STRING)}(`)\r\n  genNode(node.content, context)\r\n  push(')')\r\n}\r\n\r\nfunction genText(context, node) {\r\n  const { push } = context\r\n  push(`'${node.content}'`)\r\n}\r\n","import { NodeTypes } from './ast'\r\n\r\nconst enum TagType {\r\n  Start,\r\n  End,\r\n}\r\n\r\nexport function baseParse(content: string) {\r\n  const context = createParseContext(content)\r\n  return createRoot(parseChildren(context, []))\r\n}\r\n\r\nfunction parseChildren(context, ancestors) {\r\n  const nodes: any[] = []\r\n  while (!isEnd(context, ancestors)) {\r\n    let node\r\n    const s = context.source\r\n    if (s.startsWith('{{')) {\r\n      node = parseInterpolation(context)\r\n    } else if (s[0] === '<') {\r\n      if (/[a-z]/i.test(s[1])) {\r\n        node = parseElement(context, ancestors)\r\n      }\r\n    }\r\n    if (!node) {\r\n      node = parseText(context)\r\n    }\r\n    nodes.push(node)\r\n  }\r\n  return nodes\r\n}\r\n\r\nfunction isEnd(context, ancestors) {\r\n  // 1.当遇到结束标签的时候\r\n  const s = context.source\r\n  if (s.startsWith('</')) {\r\n    for (let i = ancestors.length - 1; i >= 0; i--) {\r\n      const tag = ancestors[i].tag\r\n      if (startsWithEndTagOpen(s, tag)) {\r\n        return true\r\n      }\r\n    }\r\n  }\r\n  // 2.source 没有值的时候\r\n  return !context.source\r\n}\r\n\r\nfunction parseText(context) {\r\n  let endIndex = context.source.length\r\n  let endToken = ['<', '{{']\r\n  for (let i = 0; i < endToken.length; i++) {\r\n    const index = context.source.indexOf(endToken[i])\r\n    if (index !== -1 && endIndex > index) {\r\n      endIndex = index\r\n    }\r\n  }\r\n\r\n  // 1.获取content\r\n  const content = parseTextData(context, endIndex)\r\n  // console.log('--------', content)\r\n  return {\r\n    type: NodeTypes.TEXT,\r\n    content,\r\n  }\r\n}\r\n\r\nfunction parseTextData(context, length) {\r\n  const content = context.source.slice(0, length)\r\n  // 推进\r\n  advanceBy(context, length)\r\n  return content\r\n}\r\n\r\nfunction parseElement(context: any, ancestors) {\r\n  // 解析tag\r\n  const element: any = parseTag(context, TagType.Start)\r\n  ancestors.push(element)\r\n  element.children = parseChildren(context, ancestors)\r\n  ancestors.pop()\r\n  if (startsWithEndTagOpen(context.source, element.tag)) {\r\n    parseTag(context, TagType.End)\r\n  } else {\r\n    throw new Error(`缺少结束标签:${element.tag}`)\r\n  }\r\n  // console.log('--------', context.source)\r\n  return element\r\n}\r\n\r\nfunction startsWithEndTagOpen(source, tag) {\r\n  return (\r\n    source.startsWith('</') &&\r\n    source.slice(2, 2 + tag.length).toLowerCase() === tag.toLowerCase()\r\n  )\r\n}\r\n\r\nfunction parseTag(context, type: TagType) {\r\n  const match: any = /^<\\/?([a-z]*)/i.exec(context.source)\r\n  const tag = match[1]\r\n  // 删除处理完成的代码\r\n  advanceBy(context, match[0].length)\r\n  advanceBy(context, 1)\r\n  if (type === TagType.End) return\r\n  return {\r\n    type: NodeTypes.ELEMENT,\r\n    tag,\r\n  }\r\n}\r\n\r\nfunction parseInterpolation(context) {\r\n  // {{message}}\r\n  const openDelimiter = '{{'\r\n  const closeDelimiter = '}}'\r\n  const closeIndex = context.source.indexOf(\r\n    closeDelimiter,\r\n    openDelimiter.length\r\n  )\r\n  advanceBy(context, openDelimiter.length)\r\n  const rawContentLength = closeIndex - openDelimiter.length\r\n  const rawContent = parseTextData(context, rawContentLength)\r\n  const content = rawContent.trim()\r\n  advanceBy(context, closeDelimiter.length)\r\n  return {\r\n    type: NodeTypes.INTERPOLATION,\r\n    content: {\r\n      type: NodeTypes.SIMPLE_EXPRESSION,\r\n      content,\r\n    },\r\n  }\r\n}\r\n\r\nfunction advanceBy(context: any, length: number) {\r\n  context.source = context.source.slice(length)\r\n}\r\n\r\nfunction createRoot(children) {\r\n  return {\r\n    children,\r\n    type: NodeTypes.ROOT,\r\n  }\r\n}\r\n\r\nfunction createParseContext(content: string) {\r\n  return {\r\n    source: content,\r\n  }\r\n}\r\n","import { NodeTypes } from './ast'\r\nimport { TO_DISPLAY_STRING } from './runtimeHelpers'\r\n\r\nexport function transform(root, options = {}) {\r\n  const context = createTransformContext(root, options)\r\n  traverseNode(root, context)\r\n  createRootCodegen(root)\r\n\r\n  root.helpers = [...context.helpers.keys()]\r\n}\r\n\r\nfunction createRootCodegen(root: any) {\r\n  const child = root.children[0]\r\n  if (child.type === NodeTypes.ELEMENT) {\r\n    root.codegenNode = child.codegenNode\r\n  } else {\r\n    root.codegenNode = root.children[0]\r\n  }\r\n}\r\n\r\nfunction createTransformContext(root: any, options: any): any {\r\n  const context = {\r\n    root,\r\n    nodeTransforms: options.nodeTransforms || [],\r\n    helpers: new Map(),\r\n    helper(key) {\r\n      context.helpers.set(key, 1)\r\n    },\r\n  }\r\n\r\n  return context\r\n}\r\n\r\nfunction traverseNode(node: any, context) {\r\n  const nodeTransforms = context.nodeTransforms\r\n  const exitFns: any = []\r\n  for (let i = 0; i < nodeTransforms.length; i++) {\r\n    const transform = nodeTransforms[i]\r\n    const onExit = transform(node, context)\r\n    if (onExit) exitFns.push(onExit)\r\n  }\r\n\r\n  switch (node.type) {\r\n    case NodeTypes.INTERPOLATION:\r\n      context.helper(TO_DISPLAY_STRING)\r\n      break\r\n    case NodeTypes.ROOT:\r\n    case NodeTypes.ELEMENT:\r\n      traverseChildren(node, context)\r\n      break\r\n\r\n    default:\r\n      break\r\n  }\r\n\r\n  let i = exitFns.length\r\n  while (i--) {\r\n    exitFns[i]()\r\n  }\r\n}\r\nfunction traverseChildren(node: any, context: any) {\r\n  const children = node.children\r\n\r\n  for (let i = 0; i < children.length; i++) {\r\n    const node = children[i]\r\n    traverseNode(node, context)\r\n  }\r\n}\r\n","import { createVNodeCall, NodeTypes } from '../ast'\r\n\r\nexport function transformElement(node, context) {\r\n  if (node.type === NodeTypes.ELEMENT) {\r\n    return () => {\r\n      // tag\r\n      const vnodeTag = `'${node.tag}'`\r\n\r\n      // props\r\n      let vnodeProps\r\n\r\n      // children\r\n      const children = node.children\r\n      let vnodeChildren = children[0]\r\n\r\n      node.codegenNode = createVNodeCall(\r\n        context,\r\n        vnodeTag,\r\n        vnodeProps,\r\n        vnodeChildren\r\n      )\r\n    }\r\n  }\r\n}\r\n","import { NodeTypes } from '../ast'\r\n\r\nexport function transformExpression(node) {\r\n  if (node.type === NodeTypes.INTERPOLATION) {\r\n    node.content = processExpression(node.content)\r\n  }\r\n}\r\n\r\nfunction processExpression(node: any) {\r\n  node.content = `_ctx.${node.content}`\r\n  return node\r\n}\r\n","import { NodeTypes } from './ast'\r\n\r\nexport function isText(node) {\r\n  return node.type === NodeTypes.TEXT || node.type === NodeTypes.INTERPOLATION\r\n}\r\n","import { NodeTypes } from '../ast'\r\nimport { isText } from '../utils'\r\n\r\nexport function transformText(node) {\r\n  if (node.type === NodeTypes.ELEMENT) {\r\n    return () => {\r\n      const { children } = node\r\n\r\n      let currentContainer\r\n      for (let i = 0; i < children.length; i++) {\r\n        const child = children[i]\r\n\r\n        if (isText(child)) {\r\n          for (let j = i + 1; j < children.length; j++) {\r\n            const next = children[j]\r\n            if (isText(next)) {\r\n              if (!currentContainer) {\r\n                currentContainer = children[i] = {\r\n                  type: NodeTypes.COMPOUND_EXPRESSION,\r\n                  children: [child],\r\n                }\r\n              }\r\n\r\n              currentContainer.children.push(' + ')\r\n              currentContainer.children.push(next)\r\n              children.splice(j, 1)\r\n              j--\r\n            } else {\r\n              currentContainer = undefined\r\n              break\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { generate } from './codegen'\r\nimport { baseParse } from './parse'\r\nimport { transform } from './transform'\r\nimport { transformElement } from './transforms/transformElement'\r\nimport { transformExpression } from './transforms/transformExpression'\r\nimport { transformText } from './transforms/transformText'\r\n\r\nexport function baseCompile(template) {\r\n  const ast: any = baseParse(template)\r\n  transform(ast, {\r\n    nodeTransforms: [transformExpression, transformElement, transformText],\r\n  })\r\n\r\n  return generate(ast)\r\n}\r\n"],"mappings":"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","names":["src_exports","__export","createApp","createVnode","createRenderer","createTextVNode","effect","getCurrentInstance","h","inject","isProxy","isReactive","isReadonly","isRef","nextTick","provide","proxyRefs","reactive","readonly","ref","registerRuntimeCompiler","renderSlots","shallowReadonly","stop","toDisplayString","unRef","__toCommonJS","src_exports","__export","createApp","createVnode","createRenderer","createTextVNode","effect","getCurrentInstance","h","inject","isProxy","isReactive","isReadonly","isRef","nextTick","provide","proxyRefs","reactive","readonly","ref","registerRuntimeCompiler","renderSlots","shallowReadonly","stop","toDisplayString","unRef","toDisplayString","value","extend","EMPTY_OBJ","isString","value","isObject","val","hasChanged","val","newValue","hasOwn","key","camelize","str","_","c","capitalize","toHandlerKey","Fragment","Text","createVnode","type","props","children","vnode","getShapeFlag","createTextVNode","text","Text","h","type","props","children","createVnode","renderSlots","slots","name","props","slot","createVnode","Fragment","activeEffect","shouldTrack","ReactiveEffect","fn","scheduler","result","cleanupEffect","effect","dep","targetMap","track","target","key","isTracking","depsMap","trackEffects","trigger","triggerEffects","options","_effect","extend","runner","stop","get","createGetter","set","createSetter","readonlyGet","shallowReadonlyGet","isReadonly","shallow","target","key","res","isObject","readonly","reactive","track","value","trigger","mutableHandlers","readonlyHandlers","shallowReadonlyHandlers","extend","reactive","raw","createActiveObject","mutableHandlers","readonly","readonlyHandlers","shallowReadonly","shallowReadonlyHandlers","isReactive","value","isReadonly","isProxy","target","baseHandlers","isObject","RefImpl","value","convert","trackRefValue","newValue","hasChanged","triggerEffects","isObject","reactive","ref","isTracking","trackEffects","isRef","unRef","proxyRefs","objectWithRefs","target","key","emit","instance","event","args","props","handleName","toHandlerKey","camelize","handler","initProps","instance","rawProps","publicPropertiesMap","i","publicInstanceProxyHandlers","instance","key","setupState","props","hasOwn","publicGetter","initSlots","instance","children","vnode","normalizeObjectSlots","slots","key","value","props","normalizeSlotValue","currentInstance","createComponentInstance","vnode","parent","component","emit","setupComponent","instance","initProps","initSlots","setupStatefulComponent","Component","publicInstanceProxyHandlers","setup","setCurrentInstance","setupResult","shallowReadonly","handleSetupResult","proxyRefs","finishComponentSetup","compiler","getCurrentInstance","registerRuntimeCompiler","_compiler","provide","key","value","currentInstance","getCurrentInstance","provides","parentProvides","inject","defaultValue","shouldUpdateComponent","prevVNode","nextVNode","prevProps","nextProps","key","createAppAPI","render","rootComponent","rootContainer","vnode","createVnode","queue","p","isFlushPending","nextTick","fn","queueJobs","job","queueFlush","flushJobs","createRenderer","options","hostCreateElement","hostPatchProp","hostInsert","hostRemove","hostSetElementText","render","vnode","container","patch","n1","n2","parentComponent","anchor","type","shapeFlag","Fragment","processFragment","Text","processText","processElement","processComponent","mountChildren","children","textNode","patchElement","mountElement","el","oldProps","EMPTY_OBJ","newProps","patchChildren","patchProps","preShapeFlag","c1","c2","unmountChildren","patchKeyChildren","parentAnchor","l2","i","e1","e2","isSomeVNodeType","nextPos","s1","s2","toBePatched","patched","keyToNewIndexMap","moved","maxNewIndexSoFar","newIndexToOldIndexMap","nextChild","prevChild","newIndex","j","increasingNewIndexSequence","getSequence","nextIndex","key","preProp","nextProp","props","val","v","updateComponent","mountComponent","instance","shouldUpdateComponent","initinalvnode","createComponentInstance","setupComponent","setupRenderEffect","effect","next","updateComponentPreRender","proxy","subTree","preSubTree","queueJobs","createAppAPI","nextVNode","arr","p","result","u","c","len","arrI","createElement","type","patchProp","el","key","prevVal","nextVal","event","insert","children","parent","anchor","remove","setElementText","text","renderer","createRenderer","createApp","args","TO_DISPLAY_STRING","CREATE_ELEMENT_VNODE","helperMapName","createVNodeCall","context","tag","props","children","CREATE_ELEMENT_VNODE","generate","ast","context","createCodegenContext","push","getFunctionPreamble","functionName","signature","genNode","VueBinging","aliasHelper","s","helperMapName","source","key","node","genText","genInterpolation","genExpression","genElement","genCompoundExpression","children","i","child","isString","helper","tag","props","CREATE_ELEMENT_VNODE","genNodeList","genNullable","nodes","args","arg","TO_DISPLAY_STRING","baseParse","content","context","createParseContext","createRoot","parseChildren","ancestors","nodes","isEnd","node","s","parseInterpolation","parseElement","parseText","i","tag","startsWithEndTagOpen","endIndex","endToken","index","parseTextData","length","advanceBy","element","parseTag","source","type","match","openDelimiter","closeDelimiter","closeIndex","rawContentLength","children","transform","root","options","context","createTransformContext","traverseNode","createRootCodegen","child","key","node","nodeTransforms","exitFns","i","onExit","TO_DISPLAY_STRING","traverseChildren","children","transformElement","node","context","vnodeTag","vnodeProps","vnodeChildren","createVNodeCall","transformExpression","node","processExpression","isText","node","transformText","node","children","currentContainer","i","child","isText","j","next","baseCompile","template","ast","baseParse","transform","transformExpression","transformElement","transformText","generate","compileToFunction","template","code","baseCompile","src_exports","registerRuntimeCompiler"]}